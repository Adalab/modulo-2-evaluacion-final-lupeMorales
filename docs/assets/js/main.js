"use strict";const inputSearch=document.querySelector(".js-inputSearch"),foundMovies=document.querySelector(".js-foundMovies"),favoriteMovie=document.querySelector(".js-favoriteMovies"),btnSearch=document.querySelector(".js-btnSearch"),btnResetSearch=document.querySelector(".js-resetSearch"),btnRemoveMyMovies=document.querySelector(".js-btnRemoveAll"),imgWrong="https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png",imgDefault="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";let filmList=[],myMovies=[];const selectedCard=[];function callFetch(){fetch("https://api.jikan.moe/v4/anime?q="+inputSearch.value).then(e=>e.json()).then(e=>{console.log(e),filmList=e.data,renderFilmList()})}function renderFilmList(){let e="";filmList.forEach(i=>{i.images.jpg.image_url===imgWrong?e+=`<li class="film-card js-filmCard" id=${i.mal_id}>\n    <img src="${imgDefault}" />\n            <h3 >${i.title}</h3>\n                </li>`:e+=`<li class="film-card js-filmCard  " id=${i.mal_id}>\n      <img src="${i.images.jpg.image_url}" />\n              <h3 >${i.title}</h3>\n                  </li>`}),foundMovies.innerHTML=e,listenerFilm()}function renderMyMovies(){let e="";myMovies.forEach(i=>{i.images.jpg.image_url===imgWrong?e+=`<li class="film-card js-favCard" id=${i.mal_id}>\n    <img src="${imgDefault}" />\n            <h3 >${i.title}</h3>\n                </li>`:e+=`<li class="film-card js-favCard " id=${i.mal_id}>\n      <img src="${i.images.jpg.image_url}" />\n              <h3 >${i.title}</h3>\n              </li>`}),favoriteMovie.innerHTML=e,listenerFavorites()}function removeMyFavorites(){myMovies=[],favoriteMovie.innerHTML="",localStorage.setItem("favoriteMovies",JSON.stringify(myMovies))}function saveMyFavorites(){localStorage.setItem("favoriteMovies",JSON.stringify(myMovies)),console.log(localStorage)}function loadMyFavorites(){const e=JSON.parse(localStorage.getItem("favoriteMovies"));null===e?console.log(e):(myMovies=e,renderMyMovies())}function handleClickSearch(e){e.preventDefault(),callFetch()}function handleClickResetInput(e){e.preventDefault(),inputSearch.value="",foundMovies.innerHTML=""}function handleClickFilm(e){const i=parseInt(e.currentTarget.id),t=filmList.find(e=>e.mal_id===i);myMovies.includes(t)||(myMovies.push(t),selectedCard.push(t)),renderMyMovies(),saveMyFavorites()}function handleClickFavorite(e){const i=parseInt(e.currentTarget.id),t=myMovies.findIndex(e=>e.mal_id===i);myMovies.splice(t,1),renderMyMovies(),console.log("idex",t)}function pressEnter(e){if(13===e.keyCode)return e.preventDefault(),callFetch(),!1}function listenerFilm(){const e=document.querySelectorAll(".js-filmCard");for(const i of e)i.addEventListener("click",handleClickFilm)}function listenerFavorites(){const e=document.querySelectorAll(".js-favCard");for(const i of e)i.addEventListener("click",handleClickFavorite)}btnResetSearch.addEventListener("click",handleClickResetInput),btnSearch.addEventListener("click",handleClickSearch),btnRemoveMyMovies.addEventListener("click",removeMyFavorites),inputSearch.addEventListener("keydown",pressEnter),loadMyFavorites();